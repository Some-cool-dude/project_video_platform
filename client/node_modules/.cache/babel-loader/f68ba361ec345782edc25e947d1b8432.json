{"ast":null,"code":"import _classCallCheck from\"/home/andrew/webprogbase2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/andrew/webprogbase2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/andrew/webprogbase2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/andrew/webprogbase2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/home/andrew/webprogbase2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/andrew/webprogbase2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import axios from'axios';import'./css/channels.css';var Channels=/*#__PURE__*/function(_React$Component){_inherits(Channels,_React$Component);function Channels(props){var _this;_classCallCheck(this,Channels);_this=_possibleConstructorReturn(this,_getPrototypeOf(Channels).call(this,props));_this.state={search:'',length:7,pages:0,step:2,array:[],defaultArray:[],isActive:1,data:null};_this.handleWithPrevNext=_this.handleWithPrevNext.bind(_assertThisInitialized(_this));_this.handleWithClick=_this.handleWithClick.bind(_assertThisInitialized(_this));_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));return _this;}_createClass(Channels,[{key:\"update\",value:function update(page,array){var _this2=this;axios.get('/api/v1/channels?page='+page+\"&search=\"+this.state.search).then(function(res){_this2.setState({isActive:page,array:array,data:res.data});}).catch(console.error);}},{key:\"goToPage\",value:function goToPage(page){var array=[];if(page-this.state.step<=1){array=this.state.defaultArray.concat([\"next\",this.state.pages]);}else if(page+this.state.step>=this.state.pages){array=[1,\"prev\"];var pages=this.state.pages;for(var i=this.state.length;i>2;i--){array[i]=pages;pages--;}}else{array=[1,\"prev\",page-1,page,page+1,\"next\",this.state.pages];}this.update(page,array);}},{key:\"handleWithPrevNext\",value:function handleWithPrevNext(event){if(event.target.id===\"next\"){this.goToPage(this.state.isActive+2);}else if(event.target.id===\"prev\"){this.goToPage(this.state.isActive-2);}else{this.goToPage(parseInt(event.target.id));}}},{key:\"handleWithClick\",value:function handleWithClick(event){this.update(parseInt(event.target.id),this.state.defaultArray.concat([\"next\",this.state.pages]));}},{key:\"handleChange\",value:function handleChange(event){var _this3=this;event.persist();axios.get('/api/v1/channels?search='+event.target.value).then(function(res){_this3.setState({isActive:1,pages:res.data.pages,array:_this3.state.defaultArray.concat([\"next\",res.data.pages]),data:res.data,search:event.target.value});});}},{key:\"componentDidMount\",value:function componentDidMount(){var _this4=this;axios.get('/api/v1/channels').then(function(res){var array=[];var count=1;for(var i=0;i<_this4.state.length-2;i++){array[i]=count;count++;}_this4.setState({pages:res.data.pages,array:array.concat([\"next\",res.data.pages]),defaultArray:array,data:res.data});}).catch(console.error);}},{key:\"render\",value:function render(){var _this5=this;if(!this.state.data)return null;var more=this.state.pages>this.state.length;var array=[];if(!more){for(var i=0;i<this.state.pages;i++){array[i]=i+1;}}return React.createElement(\"div\",{className:\"Channels\"},React.createElement(\"div\",{className:\"content\"},React.createElement(\"input\",{type:\"text\",id:\"search\",placeholder:\"Search..\",onChange:this.handleChange}),React.createElement(\"a\",{href:\"/channels/new\",className:\"btn\"},React.createElement(\"i\",{className:\"fas fa-eye\"}),\" New\"),React.createElement(\"p\",null,\" Find \",this.state.data.search,\" results\"),React.createElement(\"h1\",null,\"Channels\"),React.createElement(\"div\",null,!this.state.data.items.length?React.createElement(\"p\",null,\"No such channels\"):React.createElement(\"ul\",null,this.state.data.items.map(function(item){return React.createElement(\"li\",{key:item._id},React.createElement(\"a\",{href:\"channels/\"+item._id},item.title));})))),React.createElement(\"div\",{className:\"center\"},React.createElement(\"div\",{className:\"pagination\"},more?React.createElement(\"span\",null,\" \",this.state.array.map(function(page){return React.createElement(\"button\",{key:page.toString(),id:page.toString(),className:_this5.state.isActive===page?'active':'',onClick:_this5.handleWithPrevNext},page);}),\" \"):React.createElement(\"span\",null,\" \",array.map(function(page){return React.createElement(\"button\",{key:page.toString(),id:page.toString(),className:_this5.state.isActive===page?'active':'',onClick:_this5.handleWithClick},page);}),\" \"))));}}]);return Channels;}(React.Component);export default Channels;","map":{"version":3,"sources":["/home/andrew/webprogbase2/client/src/Channels.js"],"names":["React","axios","Channels","props","state","search","length","pages","step","array","defaultArray","isActive","data","handleWithPrevNext","bind","handleWithClick","handleChange","page","get","then","res","setState","catch","console","error","concat","i","update","event","target","id","goToPage","parseInt","persist","value","count","more","items","map","item","_id","title","toString","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport './css/channels.css';\n\nclass Channels extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n        search:'',\n        length: 7,\n        pages: 0,\n        step: 2,\n        array: [],\n        defaultArray: [],\n        isActive: 1,\n        data: null\n    }\n    this.handleWithPrevNext = this.handleWithPrevNext.bind(this);\n    this.handleWithClick = this.handleWithClick.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  update(page, array) {\n    axios.get('/api/v1/channels?page=' + page + \"&search=\" + this.state.search)\n    .then(res => {\n        this.setState({isActive: page, array: array, data: res.data});\n    })\n    .catch(console.error);\n  }\n\n  goToPage(page) {\n      let array = [];\n      if(page - this.state.step <= 1) {\n          array = this.state.defaultArray.concat([\"next\",this.state.pages]);\n      }\n      else if(page + this.state.step >= this.state.pages) {\n          array = [1, \"prev\"];\n          let pages = this.state.pages;\n          for(let i = this.state.length ; i > 2; i--) {\n            array[i] = pages;\n            pages--;\n          }\n      }\n      else {\n          array = [1,\"prev\",page-1,page,page+1,\"next\", this.state.pages];\n      }\n      this.update(page, array);\n  }\n\n  handleWithPrevNext(event) {\n    if(event.target.id === \"next\") {\n        this.goToPage(this.state.isActive + 2);\n    }\n    else if(event.target.id === \"prev\") {\n        this.goToPage(this.state.isActive - 2);\n    }\n    else {\n        this.goToPage(parseInt(event.target.id));\n    }\n  }\n\n  handleWithClick(event) {\n      this.update(parseInt(event.target.id), this.state.defaultArray.concat([\"next\", this.state.pages]));\n  }\n\n  handleChange(event) {\n    event.persist();\n    axios.get('/api/v1/channels?search=' + event.target.value)\n    .then(res => {\n        this.setState({isActive: 1, pages: res.data.pages, array: this.state.defaultArray.concat([\"next\", res.data.pages]), data: res.data, search: event.target.value});\n    })\n  }\n\n  componentDidMount() {\n    axios.get('/api/v1/channels')\n    .then(res => {\n      let array = [];\n      let count = 1;\n        for(let i = 0; i < this.state.length - 2; i++)\n        {\n          array[i] = count;\n          count++;\n        }\n        this.setState({pages: res.data.pages, array: array.concat([\"next\", res.data.pages]), defaultArray: array, data: res.data});\n    })\n    .catch(console.error);\n  }\n\n  render() {\n    if(!this.state.data) return null;\n      const more = this.state.pages > this.state.length;\n      let array = [];\n      if(!more) {\n        for(let i = 0; i < this.state.pages; i++) {\n          array[i] = i + 1;\n        }\n      }\n    return (\n        <div className=\"Channels\">\n            <div className=\"content\">\n                <input type=\"text\" id=\"search\" placeholder=\"Search..\" onChange={this.handleChange}/>\n                <a href=\"/channels/new\" className=\"btn\"><i className=\"fas fa-eye\"></i> New</a>\n                <p> Find {this.state.data.search} results</p>\n                <h1>Channels</h1>\n                <div>\n                  {!this.state.data.items.length \n                    ?(<p>No such channels</p>)\n                  :(<ul>{this.state.data.items.map(item => <li key={item._id}><a href={\"channels/\" + item._id}>{item.title}</a></li>)}</ul>)\n                  }      \n                </div>\n            </div>\n            <div className=\"center\">\n              <div className=\"pagination\">\n                {more \n                      ?(<span> {this.state.array.map(page => <button key={page.toString()} id={page.toString()} className={this.state.isActive === page ? 'active' : ''} onClick={this.handleWithPrevNext}>{page}</button>)} </span>)\n                      :(<span> {array.map(page => <button key={page.toString()} id={page.toString()} className={this.state.isActive === page ? 'active' : ''} onClick={this.handleWithClick}>{page}</button>)} </span>)\n                }\n              </div>\n            </div>\n        </div>\n    );\n\n  }\n\n}\n\nexport default Channels;"]},"metadata":{},"sourceType":"module"}