{"ast":null,"code":"import _regeneratorRuntime from\"/home/andrew/webprogbase2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _classCallCheck from\"/home/andrew/webprogbase2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/andrew/webprogbase2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/andrew/webprogbase2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/andrew/webprogbase2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/home/andrew/webprogbase2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/andrew/webprogbase2/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import axios from'axios';import'./css/video.css';var Channel=/*#__PURE__*/function(_React$Component){_inherits(Channel,_React$Component);function Channel(props){var _this;_classCallCheck(this,Channel);_this=_possibleConstructorReturn(this,_getPrototypeOf(Channel).call(this,props));_this.owner='';_this.state={data:null,update:false,delete:false,subscribe:false};_this.handleUpdate=_this.handleUpdate.bind(_assertThisInitialized(_this));_this.handleDelete=_this.handleDelete.bind(_assertThisInitialized(_this));_this.Subscribe=_this.Subscribe.bind(_assertThisInitialized(_this));_this.title=React.createRef();return _this;}_createClass(Channel,[{key:\"handleDelete\",value:function handleDelete(e){var _this2=this;e.preventDefault();axios.delete('/api/v1/channels/'+this.state.data._id,{headers:{Authorization:\"Bearer \".concat(this.props.auth)}}).then(this.props.history.push('/channels')).catch(function(err){if(err.response){if(err.response.status===401)return _this2.props.history.push('/401');else if(err.response.status===403)return _this2.props.history.push('/403');else if(err.response.status===404)return _this2.props.history.push('/404');}console.error(err);});}},{key:\"handleUpdate\",value:function handleUpdate(e){var _this3=this;e.preventDefault();this.setState({update:false});axios.put('/api/v1/channels/'+this.state.data._id,{title:this.title.current.value},{headers:{Authorization:\"Bearer \".concat(this.props.auth)}}).then(function(res){_this3.setState({data:res.data});}).catch(function(err){if(err.response){if(err.response.status===401)return _this3.props.history.push('/401');else if(err.response.status===403)return _this3.props.history.push('/403');else if(err.response.status===404)return _this3.props.history.push('/404');}console.error(err);});}},{key:\"componentDidMount\",value:function componentDidMount(){var subscribe,res;return _regeneratorRuntime.async(function componentDidMount$(_context){while(1){switch(_context.prev=_context.next){case 0:if(this.state.data){_context.next=31;break;}subscribe=false;_context.prev=2;_context.next=5;return _regeneratorRuntime.awrap(axios.get('/api/v1/me',{headers:{Authorization:\"Bearer \".concat(this.props.auth)}}));case 5:res=_context.sent;this.owner=res.data._id;_context.next=9;return _regeneratorRuntime.awrap(axios.get('/api/v1/subscribes/'+res.data._id,{headers:{Authorization:\"Bearer \".concat(this.props.auth)}}));case 9:res=_context.sent;if(res.data)subscribe=true;else subscribe=false;_context.next=13;return _regeneratorRuntime.awrap(axios.get('/api/v1/channels/'+this.props.match.params.id));case 13:res=_context.sent;this.setState({data:res.data,subscribe:subscribe});_context.next=31;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](2);if(!_context.t0.response){_context.next=30;break;}if(!(_context.t0.response.status===401)){_context.next=24;break;}return _context.abrupt(\"return\",this.props.history.push('/401'));case 24:if(!(_context.t0.response.status===403)){_context.next=28;break;}return _context.abrupt(\"return\",this.props.history.push('/403'));case 28:if(!(_context.t0.response.status===404)){_context.next=30;break;}return _context.abrupt(\"return\",this.props.history.push('/404'));case 30:console.error(_context.t0);case 31:case\"end\":return _context.stop();}}},null,this,[[2,17]]);}},{key:\"Subscribe\",value:function Subscribe(){var _this4=this;axios.post('/api/v1/subscribes',{ch_id:this.state.data._id,user_id:this.owner,subscribers:this.state.data.subscribers},{headers:{Authorization:\"Bearer \".concat(this.props.auth)}}).then(function(res){_this4.setState({data:res.data,subscribe:true});}).catch(function(err){if(err.response){if(err.response.status===401)return _this4.props.history.push('/401');else if(err.response.status===403)return _this4.props.history.push('/403');else if(err.response.status===404)return _this4.props.history.push('/404');}console.error(err);});}},{key:\"render\",value:function render(){var _this5=this;if(!this.state.data)return null;var check=this.state.data.owner_id===this.owner;return React.createElement(\"div\",{className:\"Video\"},React.createElement(\"div\",{className:\"content\"},React.createElement(\"img\",{id:\"ch\",src:this.state.data.chimgUrl,alt:\"Channel\"}),React.createElement(\"h1\",null,this.state.data.title),React.createElement(\"p\",null,React.createElement(\"b\",null,\"Created at:\"),React.createElement(\"i\",null,this.state.data.createdAt)),React.createElement(\"p\",null,React.createElement(\"b\",null,\"Subscribers:\"),this.state.data.subscribers),!this.state.subscribe&&React.createElement(\"button\",{onClick:this.Subscribe},\"Subscribe\"),this.state.update&&React.createElement(\"div\",{id:\"update\",className:\"modal\"},React.createElement(\"form\",{className:\"modal-content animate\",onSubmit:this.handleUpdate,action:\"\",method:\"post\"},React.createElement(\"span\",{onClick:function onClick(){return _this5.setState({update:false});},className:\"close\",title:\"Close Modal\"},\"\\xD7\"),React.createElement(\"div\",{className:\"container\"},React.createElement(\"label\",{htmlFor:\"title\"},React.createElement(\"b\",null,\"Title\")),React.createElement(\"input\",{type:\"text\",placeholder:\"Enter title\",name:\"title\",defaultValue:this.state.data.title,ref:this.title,maxLength:\"50\"}),React.createElement(\"button\",{type:\"submit\",className:\"submit\"},\"Update\"),React.createElement(\"button\",{type:\"button\",onClick:function onClick(){return _this5.setState({update:false});},className:\"cancelbtn\"},\"Cancel\")))),this.state.delete&&React.createElement(\"div\",{id:\"delete\",className:\"modal\"},React.createElement(\"form\",{className:\"modal-content animate\",onSubmit:this.handleDelete,action:\"\",method:\"post\"},React.createElement(\"span\",{onClick:function onClick(){return _this5.setState({delete:false});},className:\"close\",title:\"Close Modal\"},\"\\xD7\"),React.createElement(\"div\",{className:\"container\"},React.createElement(\"img\",{src:\"../images/alert.png\",alt:\"alert\"}),React.createElement(\"h2\",null,\"Are you sure you wanna delete this channel?\"),React.createElement(\"button\",{type:\"submit\",className:\"submit\"},\"Delete\"),React.createElement(\"button\",{type:\"button\",onClick:function onClick(){return _this5.setState({delete:false});},className:\"cancelbtn\"},\"Cancel\")))),check&&React.createElement(\"span\",null,React.createElement(\"form\",{action:\"/videos/new\",method:\"get\"},React.createElement(\"button\",{onClick:function onClick(){return _this5.props.history.push('/videos/new?ch='+_this5.state.data._id);},name:\"ch\",className:\"btn\"},React.createElement(\"i\",{className:\"fas fa-file-video\"}),\" Add video\")),React.createElement(\"button\",{onClick:function onClick(){return _this5.setState({update:true});},style:{width:\"auto\"}},React.createElement(\"i\",{className:\"fas fa-video\"}),\" Update\"),React.createElement(\"button\",{onClick:function onClick(){return _this5.setState({delete:true});},style:{width:\"auto\"}},React.createElement(\"i\",{className:\"fas fa-trash\"}),\" Delete\")),this.state.data.videos&&React.createElement(\"div\",{className:\"videos\"},this.state.data.videos.map(function(item){return React.createElement(\"a\",{key:item._id.toString(),href:\"/videos/\"+item._id,className:\"column hover-shadow\"},React.createElement(\"img\",{src:item.poster,alt:\"poster\"}),React.createElement(\"p\",null,item.title));}))));}}]);return Channel;}(React.Component);export default Channel;","map":{"version":3,"sources":["/home/andrew/webprogbase2/client/src/Channel.js"],"names":["React","axios","Channel","props","owner","state","data","update","delete","subscribe","handleUpdate","bind","handleDelete","Subscribe","title","createRef","e","preventDefault","_id","headers","Authorization","auth","then","history","push","catch","err","response","status","console","error","setState","put","current","value","res","get","match","params","id","post","ch_id","user_id","subscribers","check","owner_id","chimgUrl","createdAt","width","videos","map","item","toString","poster","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport axios from 'axios';\nimport './css/video.css'\n\nclass Channel extends React.Component {\n    owner = ''\n  constructor(props) {\n    super(props);\n    this.state = {\n        data: null,\n        update: false,\n        delete: false,\n        subscribe: false\n    }\n    this.handleUpdate = this.handleUpdate.bind(this);\n    this.handleDelete = this.handleDelete.bind(this);\n    this.Subscribe = this.Subscribe.bind(this);\n    this.title = React.createRef()\n  }\n\n  handleDelete(e) {\n      e.preventDefault();\n      axios.delete('/api/v1/channels/' + this.state.data._id, {headers:{Authorization: `Bearer ${this.props.auth}`}})\n      .then(this.props.history.push('/channels'))\n      .catch(err => {\n        if(err.response) {\n            if(err.response.status === 401) return this.props.history.push('/401')\n            else if(err.response.status === 403) return this.props.history.push('/403')\n            else if(err.response.status === 404) return this.props.history.push('/404')\n        }\n        console.error(err);\n      })\n  }\n\n  handleUpdate(e) {\n      e.preventDefault();\n        this.setState({update: false})\n      axios.put('/api/v1/channels/' + this.state.data._id,{title: this.title.current.value}, {headers:{Authorization: `Bearer ${this.props.auth}`}})\n      .then(res => {\n          this.setState({data: res.data});\n      })\n      .catch(err => {\n        if(err.response) {\n            if(err.response.status === 401) return this.props.history.push('/401')\n            else if(err.response.status === 403) return this.props.history.push('/403')\n            else if(err.response.status === 404) return this.props.history.push('/404')\n        }\n        console.error(err);\n      })\n  }\n\n  async componentDidMount() {\n    if(!this.state.data) {\n        let subscribe = false;\n        try {\n            let res = await axios.get('/api/v1/me', {headers:{Authorization: `Bearer ${this.props.auth}`}})\n            this.owner = res.data._id;\n            res = await axios.get('/api/v1/subscribes/' + res.data._id, {headers:{Authorization: `Bearer ${this.props.auth}`}});\n            if(res.data) subscribe = true;\n            else subscribe = false;\n            res = await axios.get('/api/v1/channels/' + this.props.match.params.id);\n            this.setState({data: res.data, subscribe: subscribe});\n        }\n        catch(err) {\n            if(err.response) {\n                if(err.response.status === 401) return this.props.history.push('/401')\n                else if(err.response.status === 403) return this.props.history.push('/403')\n                else if(err.response.status === 404) return this.props.history.push('/404')\n            }\n            console.error(err);\n        }\n    }\n  }\n\n  Subscribe() {\n        axios.post('/api/v1/subscribes', {ch_id: this.state.data._id, user_id: this.owner, subscribers: this.state.data.subscribers}, {headers:{Authorization: `Bearer ${this.props.auth}`}})\n        .then(res => {\n            this.setState({data: res.data, subscribe: true});\n        })\n        .catch(err => {\n            if(err.response) {\n                if(err.response.status === 401) return this.props.history.push('/401')\n                else if(err.response.status === 403) return this.props.history.push('/403')\n                else if(err.response.status === 404) return this.props.history.push('/404')\n            }\n            console.error(err);\n        });\n  }\n\n  render() {\n    if(!this.state.data) return null;\n    const check = this.state.data.owner_id === this.owner;\n    return (\n        <div className=\"Video\">\n            <div className=\"content\">\n            <img id=\"ch\" src={this.state.data.chimgUrl} alt=\"Channel\" />\n            <h1>{this.state.data.title}</h1>\n            <p><b>Created at:</b><i>{this.state.data.createdAt}</i></p>\n            <p><b>Subscribers:</b>{this.state.data.subscribers}</p>\n            {!this.state.subscribe && <button onClick={this.Subscribe}>Subscribe</button>}\n                {this.state.update &&\n                <div id=\"update\" className=\"modal\">\n                <form className=\"modal-content animate\" onSubmit={this.handleUpdate} action=\"\" method=\"post\">\n    \n                    <span onClick={() => this.setState({update: false})} className=\"close\" title=\"Close Modal\">&times;</span>\n    \n                    <div className=\"container\">\n                    <label htmlFor=\"title\"><b>Title</b></label>\n                    <input type=\"text\" placeholder=\"Enter title\" name=\"title\" defaultValue={this.state.data.title} ref={this.title} maxLength=\"50\" />\n\n                    <button type=\"submit\" className=\"submit\">Update</button>\n                    <button type=\"button\" onClick={() => this.setState({update: false})} className=\"cancelbtn\">Cancel</button>\n                    </div>\n    \n                </form>\n                </div>\n            }\n            {this.state.delete &&\n                <div id=\"delete\" className=\"modal\">\n                <form className=\"modal-content animate\" onSubmit={this.handleDelete} action=\"\" method=\"post\">\n    \n                    <span onClick={() => this.setState({delete: false})} className=\"close\" title=\"Close Modal\">&times;</span>\n                    <div className=\"container\">\n                            <img src=\"../images/alert.png\" alt=\"alert\" />\n                            <h2>Are you sure you wanna delete this channel?</h2>\n                            <button type=\"submit\" className=\"submit\">Delete</button>\n                            <button type=\"button\" onClick={() => this.setState({delete: false})} className=\"cancelbtn\">Cancel</button>\n                    </div>\n                </form>\n                </div>\n            }\n            {check &&\n                <span>\n                    <form action=\"/videos/new\" method=\"get\">\n                        <button onClick={() => this.props.history.push('/videos/new?ch=' + this.state.data._id)} name=\"ch\" className=\"btn\"><i className=\"fas fa-file-video\"></i> Add video</button>\n                    </form>\n                    <button onClick={() => this.setState({update: true})} style={{width: \"auto\"}}><i className=\"fas fa-video\"></i> Update</button>\n                    <button onClick={() => this.setState({delete: true})} style={{width: \"auto\"}}><i className=\"fas fa-trash\"></i> Delete</button>\n                </span>\n            }\n                {this.state.data.videos &&\n                    <div className=\"videos\">\n                    {this.state.data.videos.map(item => <a key={item._id.toString()} href={\"/videos/\" + item._id} className=\"column hover-shadow\">\n                        <img src={item.poster} alt=\"poster\"/>\n                        <p>{item.title}</p>\n                    </a>)}\n                </div>\n                }\n            </div>\n        </div>\n    );\n  }\n}\n\nexport default Channel"]},"metadata":{},"sourceType":"module"}