{"ast":null,"code":"var _jsxFileName = \"/home/andrew/webprogbase2/client/src/Channel.js\";\nimport React from 'react';\nimport axios from 'axios';\nimport './css/video.css';\n\nclass Channel extends React.Component {\n  constructor(props) {\n    super(props);\n    this.owner = '';\n    this.state = {\n      data: null,\n      update: false,\n      delete: false,\n      subscribe: false\n    };\n    this.handleUpdate = this.handleUpdate.bind(this);\n    this.handleDelete = this.handleDelete.bind(this);\n    this.Subscribe = this.Subscribe.bind(this);\n    this.title = React.createRef();\n  }\n\n  handleDelete(e) {\n    e.preventDefault();\n    axios.delete('/api/v1/channels/' + this.state.data._id, {\n      headers: {\n        Authorization: `Bearer ${this.props.auth}`\n      }\n    }).then(this.props.history.push('/channels')).catch(console.error);\n  }\n\n  handleUpdate(e) {\n    e.preventDefault();\n    this.setState({\n      update: false\n    });\n    axios.put('/api/v1/channels/' + this.state.data._id, {\n      title: this.title.current.value\n    }, {\n      headers: {\n        Authorization: `Bearer ${this.props.auth}`\n      }\n    }).then(res => {\n      this.setState({\n        data: res.data\n      });\n    }).catch(console.error);\n  }\n\n  async componentDidMount() {\n    if (!this.state.data) {\n      let subscribe = false;\n\n      try {\n        let res = await axios.get('/api/v1/me', {\n          headers: {\n            Authorization: `Bearer ${this.props.auth}`\n          }\n        });\n        this.owner = res.data._id;\n        res = await axios.get('/api/v1/subscribes/' + res.data._id, {\n          headers: {\n            Authorization: `Bearer ${this.props.auth}`\n          }\n        });\n        if (res.data) subscribe = true;else subscribe = false;\n        res = await axios.get('/api/v1/channels/' + this.props.match.params.id);\n        this.setState({\n          data: res.data,\n          subscribe: subscribe\n        });\n      } catch (err) {\n        console.error(err);\n      }\n    }\n  }\n\n  Subscribe() {\n    axios.post('/api/v1/subscribes', {\n      ch_id: this.state.data._id,\n      user_id: this.owner,\n      subscribers: this.state.data.subscribers\n    }, {\n      headers: {\n        Authorization: `Bearer ${this.props.auth}`\n      }\n    }).then(res => {\n      this.setState({\n        data: res.data,\n        subscribe: true\n      });\n    }).catch(console.error);\n  }\n\n  render() {\n    if (!this.state.data) return null;\n    const check = this.state.data.owner_id === this.owner;\n    return React.createElement(\"div\", {\n      className: \"Video\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      id: \"ch\",\n      src: this.state.data.chimgUrl,\n      alt: \"Channel\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }), React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, this.state.data.title), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, \"Created at:\"), React.createElement(\"i\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, this.state.data.createdAt)), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }, \"Subscribers:\"), this.state.data.subscribers), !this.state.subscribe && React.createElement(\"button\", {\n      onClick: this.Subscribe,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }, \"Subscribe\"), this.state.update && React.createElement(\"div\", {\n      id: \"update\",\n      className: \"modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      className: \"modal-content animate\",\n      onSubmit: this.handleUpdate,\n      action: \"\",\n      method: \"post\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      onClick: () => this.setState({\n        update: false\n      }),\n      className: \"close\",\n      title: \"Close Modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, \"\\xD7\"), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }, \"Title\")), React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Enter title\",\n      name: \"title\",\n      defaultValue: this.state.data.title,\n      ref: this.title,\n      maxLength: \"50\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, \"Update\"), React.createElement(\"button\", {\n      type: \"button\",\n      onClick: () => this.setState({\n        update: false\n      }),\n      className: \"cancelbtn\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, \"Cancel\")))), this.state.delete && React.createElement(\"div\", {\n      id: \"delete\",\n      className: \"modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      className: \"modal-content animate\",\n      onSubmit: this.handleDelete,\n      action: \"\",\n      method: \"post\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      onClick: () => this.setState({\n        delete: false\n      }),\n      className: \"close\",\n      title: \"Close Modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, \"\\xD7\"), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: \"../images/alert.png\",\n      alt: \"alert\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }), React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, \"Are you sure you wanna delete this channel?\"), React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, \"Delete\"), React.createElement(\"button\", {\n      type: \"button\",\n      onClick: () => this.setState({\n        delete: false\n      }),\n      className: \"cancelbtn\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, \"Cancel\")))), check && React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      action: \"/videos/new\",\n      method: \"get\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: () => this.props.history.push('/videos/new?ch=' + this.state.data._id),\n      name: \"ch\",\n      className: \"btn\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-file-video\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }), \" Add video\")), React.createElement(\"button\", {\n      onClick: () => this.setState({\n        update: true\n      }),\n      style: {\n        width: \"auto\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-video\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }), \" Update\"), React.createElement(\"button\", {\n      onClick: () => this.setState({\n        delete: true\n      }),\n      style: {\n        width: \"auto\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-trash\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }), \" Delete\")), this.state.data.videos && React.createElement(\"div\", {\n      className: \"videos\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, this.state.data.videos.map(item => React.createElement(\"a\", {\n      key: item._id.toString(),\n      href: \"/videos/\" + item._id,\n      className: \"column hover-shadow\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: item.poster,\n      alt: \"poster\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, item.title))))));\n  }\n\n}\n\nexport default Channel;","map":{"version":3,"sources":["/home/andrew/webprogbase2/client/src/Channel.js"],"names":["React","axios","Channel","Component","constructor","props","owner","state","data","update","delete","subscribe","handleUpdate","bind","handleDelete","Subscribe","title","createRef","e","preventDefault","_id","headers","Authorization","auth","then","history","push","catch","console","error","setState","put","current","value","res","componentDidMount","get","match","params","id","err","post","ch_id","user_id","subscribers","render","check","owner_id","chimgUrl","createdAt","width","videos","map","item","toString","poster"],"mappings":"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","sourcesContent":["import React from 'react'\nimport axios from 'axios';\nimport './css/video.css'\n\nclass Channel extends React.Component {\n    owner = ''\n  constructor(props) {\n    super(props);\n    this.state = {\n        data: null,\n        update: false,\n        delete: false,\n        subscribe: false\n    }\n    this.handleUpdate = this.handleUpdate.bind(this);\n    this.handleDelete = this.handleDelete.bind(this);\n    this.Subscribe = this.Subscribe.bind(this);\n    this.title = React.createRef()\n  }\n\n  handleDelete(e) {\n      e.preventDefault();\n      axios.delete('/api/v1/channels/' + this.state.data._id, {headers:{Authorization: `Bearer ${this.props.auth}`}})\n      .then(this.props.history.push('/channels'))\n      .catch(console.error)\n  }\n\n  handleUpdate(e) {\n      e.preventDefault();\n        this.setState({update: false})\n      axios.put('/api/v1/channels/' + this.state.data._id,{title: this.title.current.value}, {headers:{Authorization: `Bearer ${this.props.auth}`}})\n      .then(res => {\n          this.setState({data: res.data});\n      })\n      .catch(console.error)\n  }\n\n  async componentDidMount() {\n    if(!this.state.data) {\n        let subscribe = false;\n        try {\n            let res = await axios.get('/api/v1/me', {headers:{Authorization: `Bearer ${this.props.auth}`}})\n            this.owner = res.data._id;\n            res = await axios.get('/api/v1/subscribes/' + res.data._id, {headers:{Authorization: `Bearer ${this.props.auth}`}});\n            if(res.data) subscribe = true;\n            else subscribe = false;\n            res = await axios.get('/api/v1/channels/' + this.props.match.params.id);\n            this.setState({data: res.data, subscribe: subscribe});\n        }\n        catch(err) {\n            console.error(err);\n        }\n    }\n  }\n\n  Subscribe() {\n        axios.post('/api/v1/subscribes', {ch_id: this.state.data._id, user_id: this.owner, subscribers: this.state.data.subscribers}, {headers:{Authorization: `Bearer ${this.props.auth}`}})\n        .then(res => {\n            this.setState({data: res.data, subscribe: true});\n        })\n        .catch(console.error);\n  }\n\n  render() {\n    if(!this.state.data) return null;\n    const check = this.state.data.owner_id === this.owner;\n    return (\n        <div className=\"Video\">\n            <div className=\"content\">\n            <img id=\"ch\" src={this.state.data.chimgUrl} alt=\"Channel\" />\n            <h1>{this.state.data.title}</h1>\n            <p><b>Created at:</b><i>{this.state.data.createdAt}</i></p>\n            <p><b>Subscribers:</b>{this.state.data.subscribers}</p>\n            {!this.state.subscribe && <button onClick={this.Subscribe}>Subscribe</button>}\n                {this.state.update &&\n                <div id=\"update\" className=\"modal\">\n                <form className=\"modal-content animate\" onSubmit={this.handleUpdate} action=\"\" method=\"post\">\n    \n                    <span onClick={() => this.setState({update: false})} className=\"close\" title=\"Close Modal\">&times;</span>\n    \n                    <div className=\"container\">\n                    <label htmlFor=\"title\"><b>Title</b></label>\n                    <input type=\"text\" placeholder=\"Enter title\" name=\"title\" defaultValue={this.state.data.title} ref={this.title} maxLength=\"50\" />\n\n                    <button type=\"submit\" className=\"submit\">Update</button>\n                    <button type=\"button\" onClick={() => this.setState({update: false})} className=\"cancelbtn\">Cancel</button>\n                    </div>\n    \n                </form>\n                </div>\n            }\n            {this.state.delete &&\n                <div id=\"delete\" className=\"modal\">\n                <form className=\"modal-content animate\" onSubmit={this.handleDelete} action=\"\" method=\"post\">\n    \n                    <span onClick={() => this.setState({delete: false})} className=\"close\" title=\"Close Modal\">&times;</span>\n                    <div className=\"container\">\n                            <img src=\"../images/alert.png\" alt=\"alert\" />\n                            <h2>Are you sure you wanna delete this channel?</h2>\n                            <button type=\"submit\" className=\"submit\">Delete</button>\n                            <button type=\"button\" onClick={() => this.setState({delete: false})} className=\"cancelbtn\">Cancel</button>\n                    </div>\n                </form>\n                </div>\n            }\n            {check &&\n                <span>\n                    <form action=\"/videos/new\" method=\"get\">\n                        <button onClick={() => this.props.history.push('/videos/new?ch=' + this.state.data._id)} name=\"ch\" className=\"btn\"><i className=\"fas fa-file-video\"></i> Add video</button>\n                    </form>\n                    <button onClick={() => this.setState({update: true})} style={{width: \"auto\"}}><i className=\"fas fa-video\"></i> Update</button>\n                    <button onClick={() => this.setState({delete: true})} style={{width: \"auto\"}}><i className=\"fas fa-trash\"></i> Delete</button>\n                </span>\n            }\n                {this.state.data.videos &&\n                    <div className=\"videos\">\n                    {this.state.data.videos.map(item => <a key={item._id.toString()} href={\"/videos/\" + item._id} className=\"column hover-shadow\">\n                        <img src={item.poster} alt=\"poster\"/>\n                        <p>{item.title}</p>\n                    </a>)}\n                </div>\n                }\n            </div>\n        </div>\n    );\n  }\n}\n\nexport default Channel"]},"metadata":{},"sourceType":"module"}