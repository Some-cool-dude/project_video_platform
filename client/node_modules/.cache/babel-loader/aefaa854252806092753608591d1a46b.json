{"ast":null,"code":"var _jsxFileName = \"/home/andrew/webprogbase2/client/src/User.js\";\nimport React from 'react';\nimport axios from 'axios';\nimport './css/user.css';\n\nclass User extends React.Component {\n  constructor(props) {\n    super(props);\n    this.owner = {};\n    this.state = {\n      cloudName: 'hlrzutjus',\n      unsignedUploadPreset: 'lzhs5xdj',\n      data: null,\n      update: false,\n      delete: false\n    };\n    this.handleUpdate = this.handleUpdate.bind(this);\n    this.handleDelete = this.handleDelete.bind(this);\n    this.handleAdmin = this.handleAdmin.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.fullname = React.createRef();\n  }\n\n  handleDelete(e) {\n    e.preventDefault();\n    axios.delete('/api/v1/users/' + this.state.data._id, {\n      headers: {\n        Authorization: `Bearer ${this.props.auth}`\n      }\n    }).then(this.props.history.push('/users')).catch(console.error);\n  }\n\n  handleUpdate(e) {\n    e.preventDefault();\n    this.setState({\n      update: false\n    });\n    axios.put('/api/v1/users/' + this.state.data._id, {\n      fullname: this.fullname.current.value\n    }, {\n      headers: {\n        Authorization: `Bearer ${this.props.auth}`\n      }\n    }).then(res => {\n      this.setState({\n        data: res.data\n      });\n    }).catch(console.error);\n  }\n\n  handleAdmin(e) {\n    e.preventDefault();\n    axios.put('/api/v1/users/' + this.state.data._id, {\n      role: \"1\"\n    }, {\n      headers: {\n        Authorization: `Bearer ${this.props.auth}`\n      }\n    }).then(res => {\n      this.setState({\n        data: res.data\n      });\n    }).catch(console.error);\n  }\n\n  handleChange(e) {\n    if (e.target.files[0] && e.target.files[0].type.startsWith(\"image/\")) {\n      this.uploadFile(e.target.files[0]);\n    }\n  }\n\n  uploadFile(file) {\n    let url = `https://api.cloudinary.com/v1_1/${this.state.cloudName}/upload`;\n    let fd = new FormData();\n    fd.append('file', file);\n    fd.append('upload_preset', this.state.unsignedUploadPreset);\n    fd.append('folder', 'avatars');\n    axios.post(url, fd, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    }).then(res => {\n      return axios.put('/api/v1/users/' + this.state.data._id, {\n        avaUrl: res.data.secure_url\n      }, {\n        headers: {\n          Authorization: `Bearer ${this.props.auth}`\n        }\n      });\n    }).then(res => this.setState({\n      data: res.data\n    })).catch(console.error);\n  }\n\n  async componentDidMount() {\n    if (!this.state.data) {\n      try {\n        if (this.props.auth) {\n          let me = await axios.get('/api/v1/me', {\n            headers: {\n              Authorization: `Bearer ${this.props.auth}`\n            }\n          });\n          this.owner = me.data;\n        }\n\n        let id = this.props.match.params.id;\n\n        if (!id) {\n          id = this.owner._id;\n        }\n\n        ;\n        let res = await axios.get('/api/v1/users/' + id, {\n          headers: {\n            Authorization: `Bearer ${this.props.auth}`\n          }\n        });\n        this.setState({\n          data: res.data\n        });\n      } catch (err) {\n        console.error(err);\n      }\n    }\n  }\n\n  render() {\n    if (!this.state.data) return null;\n    const check = this.state.data._id === this.owner._id;\n    const admin = this.owner.role === 1 && this.state.data.role !== 1;\n    return React.createElement(\"div\", {\n      className: \"User\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, check && React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"ava\",\n      className: \"custom-file-upload\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fa fa-user-circle\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }), \" Avatar\"), React.createElement(\"input\", {\n      onChange: this.handleChange,\n      name: \"ava\",\n      type: \"file\",\n      id: \"ava\",\n      accept: \"image/*\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    })), React.createElement(\"img\", {\n      id: \"user\",\n      src: this.state.data.avaUrl,\n      alt: \"User avatar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, this.state.data.fullname), React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, this.state.data.login), React.createElement(\"i\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, this.state.data.registeredAt), React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, \"Bio:\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, \"Some text\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, \"Some long text\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, \"Some useless information about user\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, \"Text text text text text text text text text text text text text text text\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, \"Text text text text text text text text text text text text text text text\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, \"Text text text text text text text text text text text text text text text\"), this.state.update && React.createElement(\"div\", {\n      id: \"update\",\n      className: \"modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      className: \"modal-content animate\",\n      onSubmit: this.handleUpdate,\n      action: \"\",\n      method: \"post\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      onClick: () => this.setState({\n        update: false\n      }),\n      className: \"close\",\n      title: \"Close Modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, \"\\xD7\"), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"fullname\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, \"Fullname\")), React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Enter fullname\",\n      name: \"fullname\",\n      defaultValue: this.state.data.fullname,\n      ref: this.fullname,\n      maxLength: \"50\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, \"Update\"), React.createElement(\"button\", {\n      type: \"button\",\n      onClick: () => this.setState({\n        update: false\n      }),\n      className: \"cancelbtn\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, \"Cancel\")))), this.state.delete && React.createElement(\"div\", {\n      id: \"delete\",\n      className: \"modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      className: \"modal-content animate\",\n      onSubmit: this.handleDelete,\n      action: \"\",\n      method: \"post\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      onClick: () => this.setState({\n        delete: false\n      }),\n      className: \"close\",\n      title: \"Close Modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, \"\\xD7\"), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: \"../images/alert.png\",\n      alt: \"alert\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }), React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, \"Are you sure you wanna delete this user?\"), React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, \"Delete\"), React.createElement(\"button\", {\n      type: \"button\",\n      onClick: () => this.setState({\n        delete: false\n      }),\n      className: \"cancelbtn\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, \"Cancel\")))), admin && React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      action: \"\",\n      onSubmit: this.handleAdmin,\n      method: \"get\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn\",\n      type: \"submit\",\n      name: \"role\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      class: \"fas fa-user-secret\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }), \" Admin\")), React.createElement(\"button\", {\n      onClick: () => this.setState({\n        delete: true\n      }),\n      style: {\n        width: \"auto\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-trash\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }), \" Delete\")), check && React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: () => this.setState({\n        update: true\n      }),\n      style: {\n        width: \"auto\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-video\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }), \" Update\"), React.createElement(\"button\", {\n      onClick: () => this.setState({\n        delete: true\n      }),\n      style: {\n        width: \"auto\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-trash\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }), \" Delete\")))));\n  }\n\n}\n\nexport default User;","map":{"version":3,"sources":["/home/andrew/webprogbase2/client/src/User.js"],"names":["React","axios","User","Component","constructor","props","owner","state","cloudName","unsignedUploadPreset","data","update","delete","handleUpdate","bind","handleDelete","handleAdmin","handleChange","fullname","createRef","e","preventDefault","_id","headers","Authorization","auth","then","history","push","catch","console","error","setState","put","current","value","res","role","target","files","type","startsWith","uploadFile","file","url","fd","FormData","append","post","avaUrl","secure_url","componentDidMount","me","get","id","match","params","err","render","check","admin","login","registeredAt","width"],"mappings":"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","sourcesContent":["import React from 'react'\nimport axios from 'axios';\nimport './css/user.css'\n\nclass User extends React.Component {\n    owner = {}\n  constructor(props) {\n    super(props);\n    this.state = {\n        cloudName:'hlrzutjus',\n        unsignedUploadPreset:'lzhs5xdj',\n        data: null,\n        update: false,\n        delete: false\n    }\n    this.handleUpdate = this.handleUpdate.bind(this);\n    this.handleDelete = this.handleDelete.bind(this);\n    this.handleAdmin = this.handleAdmin.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.fullname = React.createRef()\n  }\n\n  handleDelete(e) {\n      e.preventDefault();\n      axios.delete('/api/v1/users/' + this.state.data._id, {headers:{Authorization: `Bearer ${this.props.auth}`}})\n      .then(this.props.history.push('/users'))\n      .catch(console.error)\n  }\n\n  handleUpdate(e) {\n      e.preventDefault();\n        this.setState({update: false})\n      axios.put('/api/v1/users/' + this.state.data._id,{fullname: this.fullname.current.value}, {headers:{Authorization: `Bearer ${this.props.auth}`}})\n      .then(res => {\n          this.setState({data: res.data});\n      })\n      .catch(console.error);\n  }\n\n  handleAdmin(e) {\n      e.preventDefault();\n      axios.put('/api/v1/users/' + this.state.data._id,{role: \"1\"}, {headers:{Authorization: `Bearer ${this.props.auth}`}})\n      .then(res => {\n        this.setState({data: res.data});\n      })\n      .catch(console.error);\n  }\n\n  handleChange(e) {\n      if(e.target.files[0] && e.target.files[0].type.startsWith(\"image/\")) {\n        this.uploadFile(e.target.files[0])\n      }\n  }\n\n  uploadFile(file) {\n    let url = `https://api.cloudinary.com/v1_1/${this.state.cloudName}/upload`;\n    let fd = new FormData();\n    fd.append('file', file);\n    fd.append('upload_preset', this.state.unsignedUploadPreset);\n    fd.append('folder', 'avatars');\n    axios.post(url, fd, {headers: {\n        'Content-Type': 'multipart/form-data'\n      }})\n      .then(res => {\n          return axios.put('/api/v1/users/' + this.state.data._id,{avaUrl: res.data.secure_url}, {headers:{Authorization: `Bearer ${this.props.auth}`}})\n      })\n      .then(res => this.setState({data: res.data}))\n      .catch(console.error);\n  }\n\n  async componentDidMount() {\n    if(!this.state.data) {\n        try {\n            if(this.props.auth) {\n                let me = await axios.get('/api/v1/me', {headers:{Authorization: `Bearer ${this.props.auth}`}});\n                this.owner = me.data;\n            }\n            let id = this.props.match.params.id;\n            if(!id) {id = this.owner._id};\n            let res = await axios.get('/api/v1/users/' + id, {headers:{Authorization: `Bearer ${this.props.auth}`}})\n            this.setState({data: res.data});\n        }\n        catch(err) {\n            console.error(err);\n        }\n    }\n  }\n\n  render() {\n    if(!this.state.data) return null;\n    const check = this.state.data._id === this.owner._id;\n    const admin = this.owner.role === 1 && this.state.data.role !== 1;\n    return (\n        <div className=\"User\">\n            <div className=\"content\">\n                {check &&\n                    <span>\n                        <label htmlFor=\"ava\" className=\"custom-file-upload\">\n                        <i className=\"fa fa-user-circle\"></i> Avatar\n                        </label>\n                        <input onChange={this.handleChange} name=\"ava\" type=\"file\" id=\"ava\" accept=\"image/*\"/>\n                    </span>\n                }\n                <img id=\"user\" src={this.state.data.avaUrl} alt=\"User avatar\"/>\n                <div className=\"right\">\n                    <h2>{this.state.data.fullname}</h2>\n                    <h3>{this.state.data.login}</h3>\n                    <i>{this.state.data.registeredAt}</i>\n                    <h2>Bio:</h2>\n                    <p>Some text</p>\n                    <p>Some long text</p>\n                    <p>Some useless information about user</p>\n                    <p>Text text text text text text text text text text text text text text text</p>\n                    <p>Text text text text text text text text text text text text text text text</p>\n                    <p>Text text text text text text text text text text text text text text text</p>\n\n                    {this.state.update &&\n                    <div id=\"update\" className=\"modal\">\n                    <form className=\"modal-content animate\" onSubmit={this.handleUpdate} action=\"\" method=\"post\">\n        \n                        <span onClick={() => this.setState({update: false})} className=\"close\" title=\"Close Modal\">&times;</span>\n        \n                        <div className=\"container\">\n                        <label htmlFor=\"fullname\"><b>Fullname</b></label>\n                        <input type=\"text\" placeholder=\"Enter fullname\" name=\"fullname\" defaultValue={this.state.data.fullname} ref={this.fullname} maxLength=\"50\" />\n        \n                        <button type=\"submit\" className=\"submit\">Update</button>\n                        <button type=\"button\" onClick={() => this.setState({update: false})} className=\"cancelbtn\">Cancel</button>\n                        </div>\n        \n                    </form>\n                    </div>\n                }\n                {this.state.delete &&\n                    <div id=\"delete\" className=\"modal\">\n                    <form className=\"modal-content animate\" onSubmit={this.handleDelete} action=\"\" method=\"post\">\n        \n                        <span onClick={() => this.setState({delete: false})} className=\"close\" title=\"Close Modal\">&times;</span>\n                        <div className=\"container\">\n                                <img src=\"../images/alert.png\" alt=\"alert\" />\n                                <h2>Are you sure you wanna delete this user?</h2>\n                                <button type=\"submit\" className=\"submit\">Delete</button>\n                                <button type=\"button\" onClick={() => this.setState({delete: false})} className=\"cancelbtn\">Cancel</button>\n                        </div>\n                    </form>\n                    </div>\n                }\n                {admin &&\n                    <span>\n                        <form action=\"\" onSubmit={this.handleAdmin} method=\"get\">\n                            <button className=\"btn\" type=\"submit\" name=\"role\"><i class=\"fas fa-user-secret\"></i> Admin</button>\n                        </form>\n                        <button onClick={() => this.setState({delete: true})} style={{width: \"auto\"}}><i className=\"fas fa-trash\"></i> Delete</button>\n                    </span>\n                }\n                {check &&\n                    <span>\n                        <button onClick={() => this.setState({update: true})} style={{width: \"auto\"}}><i className=\"fas fa-video\"></i> Update</button>\n                        <button onClick={() => this.setState({delete: true})} style={{width: \"auto\"}}><i className=\"fas fa-trash\"></i> Delete</button>\n                    </span>\n                }\n                </div>\n                </div>\n        </div>\n    );\n  }\n}\n\nexport default User"]},"metadata":{},"sourceType":"module"}